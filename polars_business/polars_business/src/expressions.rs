use crate::business_days::*;
use crate::sub::*;
use polars::prelude::*;
use pyo3_polars::derive::polars_expr;
use serde::Deserialize;

#[derive(Deserialize)]
pub struct BusinessDayKwargs {
    roll: String,
}

#[polars_expr(output_type=Date)]
fn advance_n_days(inputs: &[Series], kwargs: BusinessDayKwargs) -> PolarsResult<Series> {
    let s = &inputs[0];
    let roll = kwargs.roll;

    impl_advance_n_days(s, &roll)
}

#[derive(Deserialize)]
pub struct SubKwargs {
    holidays: Vec<i32>,
}

#[polars_expr(output_type=Int32)]
fn sub(inputs: &[Series], kwargs: SubKwargs) -> PolarsResult<Series> {
    let begin_dates = &inputs[0];
    let end_dates = &inputs[1];
    impl_sub(begin_dates, end_dates)
}
