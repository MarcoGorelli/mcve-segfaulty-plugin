from __future__ import annotations

import polars as pl
from polars.utils.udfs import _get_shared_lib_location

lib = _get_shared_lib_location(__file__)

__version__ = "0.3.18"


@pl.api.register_expr_namespace("bdt")
class ExprBusinessDateTimeNamespace:
    """
    Business day functions.
    """

    def __init__(self, expr: pl.Expr):
        self._expr = expr

    def offset_by(
        self,
        *,
        roll: RollStrategy = "raise",
    ):
        result = self._expr.register_plugin(
            lib=lib,
            symbol="advance_n_days",
            is_elementwise=True,
            kwargs={
                "roll": roll,
            },
        )
        return result

    def sub(
        self,
        *,
        holidays,
    ):
        result = self._expr.register_plugin(
            lib=lib,
            symbol="sub",
            is_elementwise=True,
            kwargs={
                "holidays": holidays,
            },
        )
        return result
